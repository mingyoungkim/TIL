# Django

## 03ì›” 22ì¼

### Authentication System

> ì •ì˜

- Authentication
  - ì¸ì¦
  - ìì‹ ì´ ëˆ„êµ¬ë¼ê³  ì£¼ì¥í•˜ëŠ” ì‚¬ëŒì˜ ì‹ ì› í™•ì¸
- Authorization
  - ê¶Œí•œ, í—ˆê°€
  - ê°€ê³  ì‹¶ì€ ê³³ìœ¼ë¡œ ê°€ë„ë¡ í˜¹ì€ ì›í•˜ëŠ” ì •ë³´ë¥¼ ì–»ë„ë¡ í—ˆìš©

- Django Authentication System
  - ì¸ì¦ + ê¶Œí•œë¶€ì—¬ í•¨ê»˜ ì œê³µ



>Authentication Built-in Forms

- djangoì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ built-in forms ì œê³µ
- íšŒì›ê°€ì…, ë¡œê·¸ì¸ ë“±



> Login & Logout

- Authentication in Web requests

  - djangoëŠ” ì„¸ì…˜ê³¼ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ **ì¸ì¦ ì‹œìŠ¤í…œì„ request ê°ì²´ì— ì—°ê²°**

  - ì´ë¥¼ í†µí•´ ì‚¬ìš©ìë¥¼ ë‚˜íƒ€ë‚´ëŠ” ëª¨ë“  ìš”ì²­ì— request.userë¥¼ ì œê³µ

  - í˜„ì¬ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•˜ì§€ ì•ŠëŠ” ê²½ìš° AnonymousUserí´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì„¤ì •

    ì•„ë‹ˆë©´, Userí´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì„¤ì •

- ë¡œê·¸ì¸ ì‚¬ìš©ìì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œ

- ë¡œê·¸ì¸

  - Session(ì´í•˜ ì„¸ì…˜)ì„ Createí•˜ëŠ” ë¡œì§ê³¼ ê°™ìŒ
  - login()
    -  djangoì˜ ë‚´ì¥ í•¨ìˆ˜
    - requestê°ì²´ì™€ Userê°ì²´ë¥¼ í†µí•´ ë¡œê·¸ì¸ ì§„í–‰
    - Djangoì˜ session frameworkë¥¼ í†µí•´ ì‚¬ìš©ìì˜ IDë¥¼ ì„¸ì…˜ì— ì €ì¥

- ë¡œê·¸ì•„ì›ƒ

  - Sessionì„ Deleteí•˜ëŠ” ë¡œì§ê³¼ ê°™ìŒ
  - logout()
    - requestê°ì²´ ë°›ê³  return ì—†ìŒ
    
    - í˜„ì¬ ìš”ì²­ì— ëŒ€í•œ DBì„¸ì…˜ ë°ì´í„° ì‚­ì œí•˜ê³ ,
    
      í´ë¼ì´ì–¸íŠ¸ ì¿ í‚¤ì—ì„œë„ sessionidë¥¼ ì‚­ì œ


```text
âœ‹ ë¡œê·¸ì¸ ì‚¬ìš©ìì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œ âœ‹
(djangoëŠ” sessionê³¼ middlewareë¥¼ í†µí•´ ì¸ì¦ì‹œìŠ¤í…œì„ request ê°ì²´ì— ì—°ê²°)

1. is_authenticated
- User classì˜ ì†ì„±(attributes) => ì†ì„±ì´ì—¬ì„œ í˜¸ì¶œí•˜ì§€ ì•ŠìŒ
- ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•
- Userì— í•­ìƒ Trueì´ë©° AnonymousUserì— ëŒ€í•´ì„œë§Œ í•­ìƒ False
- ë¡œê·¸ì¸ í–ˆëŠ”ì§€ ì•ˆí–ˆëŠ”ì§€ë§Œ íŒë‹¨ (ê¶Œí•œ ë“± ìì„¸í•œ ê²ƒë“¤ì— ëŒ€í•œ ê²ƒì€ íŒë‹¨X)

2. login required decorator
- ë¡œê·¸ì¸ì¸ í•„ìš”í•œ ê²½ìš°ë§Œ ì´ ë°ì½”ë ˆì´í„°ë¥¼ ëš«ì„ ìˆ˜ ìˆë‹¤.
- ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ í–ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” viewë¥¼ ìœ„í•œ ë°ì½”ë ˆì´í„°
- ë¡œê·¸ì¸ í•˜ì§€ ì•Šì€ ì‚¬ìš©ìë¥¼ settings.LOGIN_URLì— ì„¤ì •ëœ ê²½ë¡œë¡œ redirectì‹œí‚´
- LOGIN_URLì˜ ê¸°ë³¸ê°’ : 'accounts/login/'
```



- HTTP

  - íŠ¹ì§•

    - **ë¹„ì—°ê²°ì§€í–¥ connectionless**

      (ì„œë²„ëŠ” ì‘ë‹µ í›„ ì ‘ì† ëŠìŒ)

    - **ë¬´ìƒíƒœ stateless**

      (ì ‘ì†ì´ ëŠì–´ì§€ë©´ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°„ì˜ í†µì‹  ëë‚˜ê³  ìƒíƒœ ì €ì¥X)



> ì¿ í‚¤

- ë¸Œë¼ìš°ì €ëŠ” ì„œë²„ë¡œë¶€í„° ì „ì†¡ë°›ì€ ì¿ í‚¤ë¥¼ í´ë¼ì´ì–¸íŠ¸ **ë¡œì»¬(ë‚´ ì»´í“¨í„°)**ì— key-valueí˜•íƒœë¡œ ì €ì¥

  (DB SQLiteì— keyì™€ valueë¡œ tableì— ì €ì¥ë¨)

- ì €ì¥ëœ ì¿ í‚¤ë¥¼ ê°–ê³ ìˆë‹¤ê°€ ê°™ì€ ì„œë²„ì— ì¬ìš”ì²­ì‹œ, ì €ì¥ëœ ì¿ í‚¤ í•¨ê»˜ ì „ì†¡

  (ìš”ì²­ + ì¿ í‚¤)

- Cookie ëª©ì 

  - ì„¸ì…˜ê´€ë¦¬

    - ìƒíƒœë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œ ì‘ìš©

      (ex. ìë™ë¡œê·¸ì¸, ê³µì§€ í•˜ë£¨ ì•ˆë³´ê¸°, ë¹„ë¡œê·¸ì¸ ì¥ë°”êµ¬ë‹ˆ ë“±ë“±)

  ```text
  Session(ì„¸ì…˜)
  
  - ì‚¬ìš©ìì™€ ì„œë²„ ê°„ì˜ ì—°ê²°ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” ê²ƒ
  	ì‚¬ì´íŠ¸ì™€ íŠ¹ì • ë¸Œë¼ìš°ì € ê°„ state(ìƒíƒœ) ìœ ì§€ì‹œí‚¤ëŠ” ê²ƒ
  	(httpì˜ íŠ¹ì§•ì¸ ë¬´ìƒíƒœë¥¼ ìƒíƒœë¡œ ìœ ì§€)
  - ì¿ í‚¤ë¥¼ ì „ì†¡í•  ë•Œ session idë¥¼ ë°œê¸‰í•˜ê³  ë¸Œë¼ìš°ì €(ì„œë²„)ì— ì €ì¥
  	=> ì„¸ì…˜ì€ ì„œë²„ì— ì €ì¥í•´ë„ ë˜ê³ , í´ë¼ì´ì–¸íŠ¸ì— ì €ì¥í•´ë„ ë¨
  - í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•  ë•Œë§ˆë‹¤ í˜ì´ì§€ì™€ ì¿ í‚¤ì™€ session idë¥¼ í•¨ê»˜ ë³´ë‚´ ë¡œê·¸ì¸ ë“± ìƒíƒœë¥¼ ìœ ì§€í•  ìˆ˜ ìˆìŒ
  ```

  - ê°œì¸í™”

    - ì‚¬ìš©ì ì„ í˜¸, í…Œë§ˆ ë“± ì„¸íŒ…

      (ex. ë§ì¶¤ ê´‘ê³  ë“±ë“±)

  - íŠ¸ë˜í‚¹

    - ì‚¬ìš©ì í–‰ë™ì„ ê¸°ë¡ ë° ë¶„ì„

- Cookie lifetime (ì¼ìƒ)

  - Session cookie
    - í˜„ì¬ ì„¸ì…˜ ì¢…ë£Œì‹œ ì‚­ì œ
    - ì¼ë¶€ ë¸Œë¼ìš°ì €ëŠ” ë‹¤ì‹œ ì‹œì‘ì‹œ, ì„¸ì…˜ ë³µì›ì„ ì‚¬ìš©í•´ ê³„ì† ì§€ì†ê°€ëŠ¥í•˜ê²Œ í•¨
  - Permangent cookie
    - ìœ í†µê¸°í•œ ì˜µì…˜ì´ ìˆìŒ
    - Expires ì†ì„±ì— ì§€ì •ëœ ë‚ ì§œ í˜¹ì€ Max-Ageì†ì„±ì— ì§€ì •ëœ ê¸°ê°„ê¹Œì§€ ì €ì¥



> User objects

`django user model ë¬¸ì„œ ì°¸ì¡°`

- Usersê°€ django ì¸ì¦ ì‹œìŠ¤í…œì—ì„œ í‘œí˜„ë˜ëŠ” ëª¨ë¸
- ì¼ë°˜ì ì„ ì‚¬ì´íŠ¸ì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ì‚¬ëŒë“¤ì„ ë§í•¨
- django ì¸ì¦ ì‹œìŠ¤í…œì—ëŠ” ì˜¤ì§ í•˜ë‚˜ì˜ User Class ì¡´ì¬

```text
<ìƒì† ê³¼ì •>
models.Model ğŸ‘‰ class AbstractBaseUser ğŸ‘‰ class AbstractUser ğŸ‘‰ class User

- AbstractBaseUser : ì •ì˜ë˜ì–´ ìˆëŠ” ì •ë³´ê°€ ë„ˆë¬´ ì ìŒ (ì¶”ê°€ì ìœ¼ë¡œ ì‘ì„±í•´ì¤˜ì•¼í•˜ë‹ˆê¹Œ AbstractUserë¡œ)
- AbstractUser : User modelì„ êµ¬í˜„í•˜ëŠ” ì™„ì „í•œ ê¸°ëŠ¥ì„ ê°–ì¶˜ ê¸°ë³¸ í´ë˜ìŠ¤

âš¡ ì£¼ì˜ âš¡
Usefë¥¼ ì§ì ‘ import(ì°¸ì¡°) í•˜ë©´ ì•ˆëœë‹¤!!!
get_user_model() í•¨ìˆ˜ë¥¼ import í•´ì•¼í•¨
```

