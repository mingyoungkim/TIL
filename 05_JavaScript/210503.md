# JavaScript

## 05월 03일

### 01. AJAX

> 정의

- Asynchronous Javascript And XML (비동기식 js와 xml)
- 서버와 통신하기 위해 XMLHttpRequest 객체 활용
- 페이지 전체를 reload하지 않고도 수행되는 '비동기성'
- 사용자의 event가 있으면 전체 페이지가 아닌 일부분만을 업데이트
- 새로운 기술은 아니고 기존 기술을 잘 활용할 수 있는 방식인 새로운 '접근법'

```text
✋ 여기서 잠깐!! ✋

<XMLHttpRequest object 란?>
- 서버와 상호작용하기 위해 사용
- 전체 페이지의 새로고침 없이 url로 부터 데이터 받아올 수 있음
- 사용자가 하는 것을 방해하지 않으면서 페이지의 일부를 업데이트
- 주로 AJAX 프로그래밍에 사용
- XML 뿐만 아니라 모든 종류의 데이터 받아오는데 사용 가능
- 생성자 => XMLHttpRequest()
```



### 02. Asynchronous JS

> 동기와 비동기

- 동기식 (synchronous)
  - 순차적, 직렬적 태스크 수행
  - 요청을 보낸 후 응답을 받아야만 다음 동작이 이루어짐 (blocking)
- 비동기식 (Asynchronous)
  - 병렬적 태스크 수행
  - 요청을 보낸 후 응답 기다리지 않고 다음 동작 이루어짐 (non-blocking)
  - 요청을 다른 곳으로 보냄



> 왜 비동기를 사용?

- 사용자 경험

  - ex. 앱을 구동하는데 구동하기 위한 사전 데이터가 너무 크면 로딩시간이 얼마나 걸릴지 모름

  - 즉, 앱이 모두 멈춘 것 처럼 보임

    (JS는 single thread)

  - 따라서 동기식 요청은 코드 실행을 차단하고 화면이 멈추고 응답하지 않는 사용자 경험을 만들어버림

```text
✋ 여기서 잠깐!! ✋

<thread>
- 프로그램이 작업을 완료하는 데 사용할 수 있는 단일 프로세스
- 각 스레드는 한번에 하나의 작업만 수행 가능
- 다음 작업을 시작하려면 반드시 앞의 작업이 완료되어야 함

"JS는 single thread이다."
- 컴퓨터가 여러 개의 CPU를 가지고 있어도 main thread라 불리는 단일 스레드에서만 작업 수행
- 즉, 이벤트를 처리하는 Call Stack이 하나인 언어
- 처리 못하는 이벤트들을 다른 곳(Web API)로 보내 처리하도록 하고,
	처리된 이벤트들은 처리된 순서대로 대기실(Task queue)에 줄을 세워놓고
	Call Stack이 비면 담당자(Evnet Loop)가 대기 줄에서 가장 오래된 이벤트를 Call Stack으로 보냄
```



> Concurrency model

- Event loop를 기반으로 하는 동시성 모델

- 구조

  - Call Stack

    - 요청이 들어올 때마다 해당 요청을 순차적으로 처리하는 Stack 형태의 자료구조
    - LIFO

  - Web API (Browser API)

    - 브라우저가 제공함
    - JavaScript 엔진이 아닌 브라우저 영역에서 제공하는 API
    - DOM events, AJAX로 데이터를 가져오는 시간이 소요되는 일들을 처리

  - Task Queue (Event Queue, Message Queue)

    - 콜백 함수가 대기하는 Queue형태의 자료구조
    - FIFO
    - main thread가 끝난 후 실행, 후속 js코드가 차단되는 것을 방지 => main thread가 계속 실행되도록

  - Event Loop

    - Call Stack이 비어 있는 지 확인

    - 빈 경우, Task Queue에서 실행 대기중인 콜백 여부 확인 후,

      가장 앞에 있는 콜백을 Call Stack 으로 push



> Zero delays

- 실제로 0초 후에 콜백이 실행된다는 의미가 아님
- 실행은 Task Queue에 대기중인 작업 수에 따라 다르다.
- delay는 JS가 요청을 처리하는 데 필요한 최소 시간 (보장 시간이 아님)



> 순차적인 비동기 처리

`Web API로 들어오는 순서는 중요치 않고, 어떤 이벤트가 먼저 처리되느냐가 중요 (실행순서 불명확)`

- Async callbacks
  - 백그라운드에서 실행을 시작할 함수를 호출할 때 인자로 지정된 함수
  - `addEventListner()`의 두번째 인자
- promise-style